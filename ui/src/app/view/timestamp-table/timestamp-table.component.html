<p-table #dt [filterDelay]="0" [sortOrder]="1" [value]="timestamps" sortField="logOfTimestamp"
         [globalFilterFields]="['timestampType','classifierCode','eventTypeCode','portOfCall','portPrevious', 'portNext']">
  <ng-template pTemplate="caption">
    <div class="p-grid">
      <div class="p-col"></div>
      <div class="p-col"></div>
      <div class="p-col globalSearch">
        <div class="p-input-icon-left globalSearch">
          <i class="pi pi-search"></i>
          <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                 placeholder="Search in table" class="p-column-filter"
                 pTooltip="This enables table search containing for Timestamp, Classifier Code, Event Type Code, Port From, Port To and Next Port">
        </div>
      </div>
    </div>
  </ng-template>
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 2%">#</th>
      <th style="width: 7%" pSortableColumn="timestampType" pTooltip="An estimated, requested, planned or actual timestamp of an event"
          tooltipPosition="top" tooltipStyleClass="ToolTipClass">Timestamp
        <p-sortIcon field="timestampType"></p-sortIcon>
      </th>
      <th style="width: 7%">Sequence</th>
      <th pSortableColumn="logOfTimestamp" pTooltip="When is the timestamp communicated (local time for user)" tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Log of Timestamp
        <p-sortIcon field="logOfTimestamp"></p-sortIcon>
      </th>
      <th pSortableColumn="eventTimestamp" pTooltip="What is the estimated, requested, planned or actual timestamp of the event. (local time for user)" tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Event. Timestamp
        <p-sortIcon field="eventTimestamp"></p-sortIcon>
      </th>
      <th style="width: 7%" pSortableColumn="portPrevious" pTooltip="What port does the vessel come from?"
          tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Previous Port
        <p-sortIcon field="portPrevious"></p-sortIcon>
      </th>
      <th style="width: 7%" pSortableColumn="portOfCall" pTooltip="What is the approaching port of call?}" tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Port of Call
        <p-sortIcon field="portOfCall"></p-sortIcon>
      </th>
      <th style="width: 7%" pSortableColumn="portNext" pTooltip="What is the next port in the rotation" tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Next Port
        <p-sortIcon field="portNext"></p-sortIcon>
      </th>
      <th style="width: 7%" pSortableColumn="direction" pTooltip="What is the vessel direction, e.g. north or southbound" tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Direction
        <p-sortIcon field="direction"></p-sortIcon>
      </th>
      <th pSortableColumn="terminal" style="width: 14%" pTooltip="What is the name or SMDG code of the terminal?" tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Terminal ID
        <p-sortIcon field="terminal"></p-sortIcon>
      </th>
      <th pSortableColumn="locationId" pTooltip="What is the location of the timestamp, e.g. where is the vessel at sea (long/lat) or where at berth is the arrival" tooltipPosition="top"
          tooltipStyleClass="ToolTipClass">Location ID
        <p-sortIcon field="locationId"></p-sortIcon>
      </th>
      <th style="width: 5%"></th>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>

    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-timestamp>
    <tr>
      <td style="width: 2%">{{ timestamp.id }}</td>
      <td style="width: 7%">{{ timestamp.timestampType | portCallTimestampTypeToStringPipe: null }}</td>
      <td>+1</td>
      <td>{{ timestamp.logOfTimestamp | date: 'MM/dd/yyyy HH:mm ZZZZ' }}</td>
      <td>{{ timestamp.eventTimestamp | date: 'MM/dd/yyyy HH:mm ZZZZ' }}</td>
      <td style="width: 7%">
        <div>{{ (timestamp.portPrevious | portIdToPort: ports).unLocode}}</div>
        <div class="rowDetails">{{ (timestamp.portPrevious | portIdToPort: ports).name}}</div>
      </td>
      <td style="width: 7%">
        <div>{{ (timestamp.portOfCall | portIdToPort: ports).unLocode}}</div>
        <div class="rowDetails">{{ (timestamp.portOfCall | portIdToPort: ports).name}}</div>
      </td>
      <td style="width: 7%">
        <div>{{ (timestamp.portNext | portIdToPort: ports).unLocode}}</div>
        <div class="rowDetails">{{ (timestamp.portNext | portIdToPort: ports).name}}</div>
      </td>
      <td style="width: 7%">{{ timestamp.direction }}</td>
      <td style="width: 7%">
        <!--   somehow there is a porblem acessing the terminals   -->
        <div *ngIf="terminals.length > 0">
          <div pTooltip="{{(timestamp.terminal | terminalIdToTerminal: terminals).terminalName}}" tooltipPosition="top"
               tooltipStyleClass="ToolTipClass">{{ (timestamp.terminal | terminalIdToTerminal: terminals).smdgCode}}</div>
        </div>
      </td>
      <td>{{ timestamp.locationId }}</td>
      <td style="width: 5%">
        <p-button *ngIf="timestamps[timestamps.length - 1].id == timestamp.id" icon="pi pi-trash"
                  (click)="deleteTimestamp(timestamp)" pTooltip="Delete the timestamp" tooltipPosition="top"
                  tooltipStyleClass="ToolTipClass"></p-button>
      </td>
    </tr>
  </ng-template>
</p-table>

<p-confirmDialog key="deletetimestamp" header="Confirmation" icon="pi pi-exclamation-triangle"
                 appendTo="body"></p-confirmDialog>

<p-toast key="TimestampRemoveSuccess" position="bottom-right"></p-toast>
<p-toast key="TimestampRemoveError" position="bottom-right"></p-toast>
